# Zapier Integration Guide

How to integrate Viraltracker API with Zapier automations.

## Overview

Zapier connects Viraltracker to 5000+ apps for automated workflows.

## Example Zap: Daily Viral Report to Email

### Trigger
**Schedule by Zapier**
- Frequency: Every day
- Time: 9:00 AM

### Action 1: Webhooks by Zapier (POST Request)

**URL**: `https://your-app.up.railway.app/agent/run`

**Method**: POST

**Headers**:
```
Content-Type: application/json
X-API-Key: your-api-key-here
```

**Data** (JSON):
```json
{
  "prompt": "Find viral tweets from the last 24 hours",
  "project_name": "yakety-pack-instagram"
}
```

### Action 2: Gmail - Send Email

**To**: team@yourcompany.com

**Subject**: Daily Viral Content Report - {{zap_run_timestamp}}

**Body**:
```
Viral Content Analysis
=====================

{{result}}

---
Generated by Viraltracker API
```

## Example Zap: Slack Alert for Viral Content

### Trigger
**Schedule by Zapier**
- Every 4 hours

### Action 1: Webhooks - POST to Viraltracker
```
URL: https://your-app.up.railway.app/tools/find-outliers
Method: POST
Headers: X-API-Key
Body:
{
  "project_name": "your-project",
  "hours_back": 4,
  "threshold": 2.5,
  "limit": 5
}
```

### Action 2: Filter by Zapier
**Only continue if**: `outlier_count` > 0

### Action 3: Slack - Send Channel Message
```
Channel: #viral-content
Message:
üî• Found {{data.outlier_count}} viral tweets in the last 4 hours!

Top performer:
"{{data.outliers.0.tweet.text}}"
üíö {{data.outliers.0.tweet.like_count}} likes
üëÅ {{data.outliers.0.tweet.view_count}} views
```

## Example Zap: Airtable Integration

### Trigger
**Schedule by Zapier** - Daily at 9 AM

### Action 1: Viraltracker API Call
(Same as above)

### Action 2: Airtable - Create Record
```
Base: Viral Content Tracker
Table: Daily Reports
Fields:
- Date: {{zap_run_timestamp}}
- Outlier Count: {{data.outlier_count}}
- Report (Long Text): {{result}}
- Top Tweet: {{data.outliers.0.tweet.text}}
- Engagement Score: {{data.outliers.0.tweet.engagement_score}}
```

## Using Webhooks by Zapier

Zapier's Webhooks app allows custom API calls:

### Step 1: Add Webhooks Action
1. Choose "Webhooks by Zapier"
2. Select "POST"

### Step 2: Configure Request
```
URL: https://your-app.up.railway.app/agent/run
Payload Type: JSON
Headers:
  X-API-Key: your-secure-key
  Content-Type: application/json
Data:
  prompt: your prompt here
  project_name: your-project
  model: openai:gpt-4o
```

### Step 3: Test & Review
- Click "Test & Review"
- Zapier sends request and shows response
- Verify `success: true` in response

## Available Endpoints

### Natural Language (Agent)
```
POST /agent/run
{
  "prompt": "Find viral tweets from yesterday"
}
```

### Direct Tool Access
```
POST /tools/find-outliers
POST /tools/analyze-hooks
```

## Error Handling

### Zapier Filters
Add "Filter by Zapier" step after API call:

```
Only continue if: success = true
```

### Path for Errors
Use "Paths by Zapier" to handle errors:

**Path A** (Success): `success` = true ‚Üí Continue workflow
**Path B** (Error): `success` = false ‚Üí Send error alert

## Rate Limits

Viraltracker API limits:
- **10 requests/minute** per IP (agent endpoint)
- **20 requests/minute** for direct tools

For Zapier:
- Add 6-second delay between actions if making multiple calls
- Use "Delay by Zapier" action

## Multi-Step Zaps

### Content Research Workflow
```
1. Schedule (daily)
2. Viraltracker (find viral hooks)
3. ChatGPT (generate content ideas)
4. Google Docs (create document)
5. Slack (notify team)
```

### Competitive Analysis
```
1. RSS Feed (competitor blog)
2. Viraltracker (analyze similar topics)
3. Airtable (log insights)
4. Email (weekly digest)
```

## Best Practices

1. **Use Formatter** to clean API responses
2. **Add delays** between rate-limited calls
3. **Test each step** before enabling Zap
4. **Monitor Zap history** for failures
5. **Use Paths** for conditional logic

## Troubleshooting

### 401 Unauthorized Error
- Check X-API-Key header is correct
- Verify no extra spaces in API key
- Ensure header name is exact: `X-API-Key`

### 429 Too Many Requests
- Add "Delay by Zapier" between steps
- Reduce Zap frequency
- Use direct tool endpoints (higher limits)

### Response Parsing Issues
- Use "Formatter by Zapier" to extract JSON
- Check response structure in test
- Verify `success: true` before continuing

## Zapier Tables Integration

Store results in Zapier Tables:

```
1. Viraltracker API call
2. Create Record in Zapier Tables
   - Table: Viral Analysis
   - Fields: Date, Project, Outlier Count, Top Tweet
```

## Resources

- [Zapier Webhooks Documentation](https://zapier.com/apps/webhook/integrations)
- [API Requests in Zapier](https://zapier.com/help/create/code-webhooks/make-an-api-request-in-zapier)
- [Zapier Filters](https://zapier.com/help/create/customize/add-conditions-to-zaps-with-filters)
